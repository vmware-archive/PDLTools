<!-- HTML header for doxygen 1.8.7-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="pdltools_extra.css" rel="stylesheet" type="text/css"/>
<!-- Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-47128600-1', 'auto');
    ga('send', 'pageview');
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="pdl.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">PDL Tools
   &#160;<span id="projectnumber">1.8</span>
   </div>
   <div id="projectbrief">User Documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="gettingstarted.html"><span>Getting&#160;Started</span></a></li>
      <li><a href="installpage.html"><span>Installation</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="changelog.html"><span>Change&#160;Log</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Groups</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">balance_dataset<div class="ingroups"><a class="el" href="group__grp__balancing.html">Balancing datasets</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><b>Contents</b> </p><ul>
<li class="level1">
<a href="#balance_dataset_syntax">Syntax</a> </li>
<li class="level1">
<a href="#balance_dataset_usage">Usage</a> </li>
<li class="level1">
<a href="#balance_dataset_example">Example</a> </li>
</ul>
</div><dl class="section user"><dt>About</dt><dd>Balance a dataset for classification models.</dd></dl>
<p><a class="anchor" id="balance_dataset_syntax"></a></p><dl class="section user"><dt>Syntax</dt><dd><pre class="syntax">
FUNCTION balance_dataset(
          imbalanced_table_name text, 
          id_column_name text,
          label_column_name text,
          balanced_output_table_name text
       );
RETURNS TEXT;
</pre></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">input_table</td><td>A text field representing the name of the input table </td></tr>
    <tr><td class="paramname">id_col</td><td>A text field representing the name of the ID column </td></tr>
    <tr><td class="paramname">label_col</td><td>A text field representing name of the class label </td></tr>
    <tr><td class="paramname">output_table</td><td>A text field representing the name of the output table </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A status message indicating success/failure.</dd></dl>
<p><a class="anchor" id="balance_dataset_usage"></a></p><dl class="section user"><dt>Usage</dt><dd>Given a table with varying number of records for each class label, this function will create an output table with each class label having approximately the same number of records. This is achieved by repeating each row of every under-represented class by a certain amount so that the expected number of rows from the underrepresented classes equals the total number of rows in the majority class.</dd></dl>
<p>The exact number may either be the floor of the expectation or its ceil, and the choice between these is probabilistic, such that the expectation is the correct expectation.</p>
<p><a class="anchor" id="balance_dataset_example"></a></p><dl class="section user"><dt>Examples</dt><dd><pre class="fragment">user=# drop table if exists unbalanced cascade;
DROP TABLE
user=# create table unbalanced
user-# ( 
user(#     id int, 
user(#     f1 float, 
user(#     f2 float, 
user(#     f3 float, 
user(#     label text
user(# ) distributed by (id);
CREATE TABLE
user=# 
user=# insert into unbalanced
user-# values
user-# (1, 0.35, 0.52, 0.61, 'a'),
user-# (2, 0.24, 0.51, 0.63, 'a'),
user-# (3, 0.31, 0.49, 0.67, 'a'),
user-# (5, 0.20, 0.35, 0.26, 'b'),
user-# (6, 0.21, 0.36, 0.28, 'b'),
user-# (7, 0.49, 0.70, 0.90, 'c');
INSERT 0 6
user=# select * from unbalanced;
 id |  f1  |  f2  |  f3  | label 
----+------+------+------+-------
  2 | 0.24 | 0.51 | 0.63 | a
  6 | 0.21 | 0.36 | 0.28 | b
  1 | 0.35 | 0.52 | 0.61 | a
  3 | 0.31 | 0.49 | 0.67 | a
  5 |  0.2 | 0.35 | 0.26 | b
  7 | 0.49 |  0.7 |  0.9 | c
(6 rows)
user=# select label, 
user-#        count(distinct id) 
user-# from unbalanced 
user-# group by 1 order by 2;
 label | count 
-------+-------
 c     |     1
 b     |     2
 a     |     3
(3 rows)
user=# drop table if exists balanced_dataset cascade;
DROP TABLE
user=# select balance_dataset('unbalanced', 'id','label','balanced_dataset');
              balance_dataset               
--------------------------------------------
 Balanced dataset created: balanced_dataset
(1 row)

user=# 
user=# select label, 
user-#        count(distinct id_balanced) 
user-# from balanced_dataset 
user-# group by 1 order by 2;
 label | count 
-------+-------
 b     |     2
 c     |     3
 a     |     3
(3 rows)
</pre> </dd></dl>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.nl/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.7
</small></address>
</body>
</html>
