<!-- HTML header for doxygen 1.8.7-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="pdltools_extra.css" rel="stylesheet" type="text/css"/>
<!-- Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-47128600-1', 'auto');
    ga('send', 'pageview');
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="pdl.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">PDL Tools
   &#160;<span id="projectnumber">1.8</span>
   </div>
   <div id="projectbrief">User Documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="gettingstarted.html"><span>Getting&#160;Started</span></a></li>
      <li><a href="installpage.html"><span>Installation</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="changelog.html"><span>Change&#160;Log</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Groups</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">mf_auc<div class="ingroups"><a class="el" href="group__grp__prediction__metrics.html">Prediction Metrics</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><b>Contents</b> </p><ul>
<li class="level1">
<a href="#mf_auc_syntax">Syntax</a> </li>
<li class="level1">
<a href="#mf_auc_linkage_usage">Usage</a> </li>
<li class="level1">
<a href="#mf_auc_example">Example</a> </li>
</ul>
</div><dl class="section user"><dt>About</dt><dd>A function calculating the area under the ROC curve, for use in binary classification.</dd></dl>
<p><a class="anchor" id="mf_auc_syntax"></a></p><dl class="section user"><dt>Syntax</dt><dd><pre class="syntax">
FUNCTION mf_auc(
                              in_table TEXT,
                              prediction_col TEXT, observed_col TEXT)
RETURNS DOUBLE PRECISION
</pre> <pre class="syntax">
FUNCTION mf_auc(
                              in_table TEXT,
                              prediction_col TEXT, observed_col TEXT,
                              out_table TEXT,
                              grouping_col TEXT)
RETURNS VOID
</pre></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">in_table</td><td>Name of the input table. </td></tr>
    <tr><td class="paramname">prediction_col</td><td>Name of the column of predicted values. (These are numeric values corresponding to likelihood/probability: a larger value corresponds to greater certainty that the observed value will be '1', lower value corresponds to a greater certainty that it will be '0'.) </td></tr>
    <tr><td class="paramname">observed_col</td><td>Name of the column of observed values. (A 0/1 column.) </td></tr>
    <tr><td class="paramname">out_table</td><td>Name of the output table. </td></tr>
    <tr><td class="paramname">grouping_col</td><td>Argument indicating which column(s) to group by. If grouping by multiple columns, these should be passed as a comma-separated list.</td></tr>
  </table>
  </dd>
</dl>
<p><a class="anchor" id="mf_auc_usage"></a></p><dl class="section user"><dt>Usage</dt><dd>A function calculating the area under the Receiver Operating Characteristic curve for binary classification (the AUC). Without grouping, this is a number and is returned immediately as the functon's return value. With grouping, the answer is different for each group, and is given in the table specified in <em>'output_table'</em>. The grouping columns appear in the output as additional columns, with their original names.</dd></dl>
<p>The ROC curve is the curve relating the classifier's TPR and FPR metrics. (See <a class="el" href="group__grp__mf__binary__classifier.html">mf_binary_classifier</a> for a definition of these metrics.)</p>
<p>Rows with NULL observations are ignored in the calculation. The predicted value should not be NULL.</p>
<p><a class="anchor" id="mf_auc_example"></a></p><dl class="section user"><dt>Examples</dt><dd>Assume we have trained a model and used it to perform binary classification on certain values of the independent parameters. (In the example, these values are taken to be from a "test_set", implying that they are distinct from those values on which the model was trained. However, in real usage the function may be used also on the training set, although the interpretation of the results will be different.) In parallel, for each set of values of the independent parameters we also have the ground truth, e.g. an observed value.</dd></dl>
<p>The observed value is a 0/1 binary classification, and the predicted value is a number, corresponding to the probability/likelihood of a '1'. For example, such a value may be the resulto of logistic regression.</p>
<p>We place the predicted and observed values into the "pred" and "obs" columns of the "test_set" table, respectively.</p>
<p>For the example, we will create the following dummy test_set table:</p>
<div class="fragment"><div class="line">user=# CREATE TABLE test_set AS</div>
<div class="line">user-#   SELECT ((a*8)::integer)/8.0 pred,</div>
<div class="line">user-#          ((a*0.5+random()*0.5)&gt;0.5)::integer obs,</div>
<div class="line">user-#          (random()&gt;0.5)::integer m1,</div>
<div class="line">user-#          (random()&gt;0.5)::integer m2</div>
<div class="line">user-#   FROM (select random() as a from generate_series(1,100)) x</div>
<div class="line">user-# DISTRIBUTED RANDOMLY;</div>
</div><!-- fragment --><p>In this toy example, "obs" takes the place of the observed parameter, and "pred" takes the place of its approximation by a model. We are interested in determining the quality of this approximation.</p>
<div class="fragment"><div class="line">user=# SELECT <a class="code" href="prediction__metrics_8sql__in.html#a9e226129f4b344885baab4bcc5c1c4ea">mf_auc</a>(<span class="stringliteral">&#39;test_set&#39;</span>,<span class="stringliteral">&#39;pred&#39;</span>,<span class="stringliteral">&#39;obs&#39;</span>);</div>
<div class="line">     <a class="code" href="prediction__metrics_8sql__in.html#a9e226129f4b344885baab4bcc5c1c4ea">mf_auc</a>     </div>
<div class="line">----------------</div>
<div class="line"> 0.814769481844</div>
<div class="line">(1 row)</div>
</div><!-- fragment --><p>Suppose, now, that we are interested in observing this quality metric separately for each group defined by the values of <code>'m1'</code> and <code>'m2'</code>.</p>
<div class="fragment"><div class="line">user=# SELECT pdltools.mf_auc(<span class="stringliteral">&#39;test_set&#39;</span>,<span class="stringliteral">&#39;pred&#39;</span>,<span class="stringliteral">&#39;obs&#39;</span>,<span class="stringliteral">&#39;out_table&#39;</span>,<span class="stringliteral">&#39;m1, m2&#39;</span>);</div>
<div class="line"> <a class="code" href="prediction__metrics_8sql__in.html#a9e226129f4b344885baab4bcc5c1c4ea">mf_auc</a> </div>
<div class="line">--------</div>
<div class="line"> </div>
<div class="line">(1 row)</div>
<div class="line"></div>
<div class="line">michaeldb=# SELECT * from out_table;</div>
<div class="line"> m1 | m2 |                     auc                     </div>
<div class="line">----+----+---------------------------------------------</div>
<div class="line">  0 |  1 | 0.70614035087719298245804824561403508771930</div>
<div class="line">  1 |  0 | 0.93000000000000000000000000000000000000000</div>
<div class="line">  0 |  0 | 0.87797619047619047619250000000000000000000</div>
<div class="line">  1 |  1 | 0.78968253968253968254051587301587301587305</div>
<div class="line">(4 rows)</div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="group__grp__mf__binary__classifier.html" title="Metrics for binary classification. ">mf_binary_classifier</a> </dd></dl>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.nl/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.7
</small></address>
</body>
</html>
