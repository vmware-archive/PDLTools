<!-- HTML header for doxygen 1.8.7-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="pdltools_extra.css" rel="stylesheet" type="text/css"/>
<!-- Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-47128600-1', 'auto');
    ga('send', 'pageview');
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="pdl.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">PDL Tools
   &#160;<span id="projectnumber">1.8</span>
   </div>
   <div id="projectbrief">User Documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="gettingstarted.html"><span>Getting&#160;Started</span></a></li>
      <li><a href="installpage.html"><span>Installation</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="changelog.html"><span>Change&#160;Log</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Groups</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">array_utilities<div class="ingroups"><a class="el" href="group__grp__genutils.html">Generic Utilities</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><b>Contents</b> </p><ul>
<li class="level1">
<a href="#cols2vec_syntax">Syntax</a> </li>
<li class="level1">
<a href="#cols2vec_usage">Usage</a> </li>
<li class="level1">
<a href="#cols2vec_example">Example</a> </li>
</ul>
</div><dl class="section user"><dt>About</dt><dd>Convert all feature columns in your table into an array in a single column.</dd></dl>
<p><a class="anchor" id="cols2vec_syntax"></a></p><dl class="section user"><dt>Syntax</dt><dd><pre class="syntax">
FUNCTION cols2vec(
          table_name text,
          exclude_columns text[],
          output_table text.
          distribution_key text
       )
RETURNS TEXT;
</pre></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">table_name</td><td>A text field representing the name of the input table (as schema_name.table_name) </td></tr>
    <tr><td class="paramname">exclude_columns</td><td>An array of text fields representing the columns that will NOT be included in the output array </td></tr>
    <tr><td class="paramname">output_table</td><td>A text field representing the name of the output table (as schema_name.output_table_name) </td></tr>
    <tr><td class="paramname">distribution_key</td><td>The distribution key to use. If 'random' or '' (empty string) the table is distributed randomly </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A status message indicating success/failure.</dd></dl>
<p><a class="anchor" id="cols2vec_usage"></a></p><dl class="section user"><dt>Usage</dt><dd>Given a table with varying number of columns, this function will create an output table that will contain all the feature columns into an array. It will also contain the names of the features into another array so that this process can be reversed using the function vec2cols from array_utilities in PDLTools.</dd></dl>
<p>The columns that need NOT be included in the feature array need to be specified in the exclude_columns field.</p>
<p><a class="anchor" id="cols2vec_example"></a></p><dl class="section user"><dt>Examples</dt><dd><pre class="fragment">CREATE SCHEMA test;

DROP TABLE IF EXISTS test.vec2cols;
CREATE TABLE test.vec2cols (
    id              bigint,
    feat_vector     integer[],
    feat_names      text[],
    label           int,
    other_col       float
) distributed by (id);

INSERT INTO test.vec2cols
VALUES
(1, ARRAY[1,2,3,4,5], ARRAY['feat1', 'feat2','feat3', 'feat4', 'feat5'],0, 0.5),
(2, ARRAY[2,2,2,2,2], ARRAY['feat1', 'feat2','feat3', 'feat4', 'feat5'],1, 0.3),
(3, ARRAY[1,2,2,4,6], ARRAY['feat1', 'feat2','feat3', 'feat4', 'feat5'],0, 1.1),
(4, ARRAY[1,2,2,1,1], ARRAY['feat1', 'feat2','feat3', 'feat4', 'feat5'],1, 0.4);

drop table if exists test.output_cols2vec;

select cols2vec(
      'test.cols2vec',                 -- input table
      array['label','other_col'],-- exclude columns on feature vector
      'test.utput_cols2vec',           -- output table
      'id'                       -- distribution key
);

select * from test.output_cols2vec;

Expected output:

 id | label | other_col | feature_vector |    feature_names    
----+-------+-----------+----------------+---------------------
  3 |     0 |       1.1 | {0,0,0.1}      | {feat1,feat2,feat3}
  2 |     1 |       0.3 | {0,1,0.3}      | {feat1,feat2,feat3}
  1 |     0 |       0.9 | {1,1,0.5}      | {feat1,feat2,feat3}
  4 |     1 |       0.4 | {1,0,0.9}      | {feat1,feat2,feat3}
(4 rows)

DROP SCHEMA test;
</pre> </dd></dl>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.7
</small></address>
</body>
</html>
