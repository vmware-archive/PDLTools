<!-- HTML header for doxygen 1.8.7-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="pdltools_extra.css" rel="stylesheet" type="text/css"/>
<!-- Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-47128600-1', 'auto');
    ga('send', 'pageview');
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="pdl.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">PDL Tools
   &#160;<span id="projectnumber">1.8</span>
   </div>
   <div id="projectbrief">User Documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="gettingstarted.html"><span>Getting&#160;Started</span></a></li>
      <li><a href="installpage.html"><span>Installation</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="changelog.html"><span>Change&#160;Log</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Groups</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">elastic_net<div class="ingroups"><a class="el" href="group__grp__grid__search.html">Grid Search</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><b>Contents</b> </p><ul>
<li class="level1">
<a href="#elasticnet_syntax">Syntax</a> </li>
<li class="level1">
<a href="#elasticnet_usage">Usage</a> </li>
<li class="level1">
<a href="#elasticenet_example">Example</a> </li>
</ul>
</div><dl class="section user"><dt>About</dt><dd>Elastic Nets combine the the benefits of L1 and L2 regularizations with regression models. L1 regularization results in very sparse features, while L2 regularization results in features whose coefficients are closer to zero. By adjusting the alpha and lambda parameters, we can achieve the benefits of both L1 and L2 regularization. Refer to <a href="https://madlib.incubator.apache.org/docs/latest/group__grp__elasticnet.html">MADlib Elastic Net Regression</a> for more information.</dd></dl>
<p><a class="anchor" id="elasticnet_syntax"></a></p><dl class="section user"><dt>Syntax</dt><dd><pre class="syntax">
FUNCTION gs_elasticnet_cv(
    tbl_source text, 
    tbl_result text,
    col_dep_var text,
    col_ind_var text,
    regress_family text,
    alphas float8[],
    lambdas float8[],
    id_column text,
    mdl_table text,
    k_folds int,
    standardize boolean, -- OPTIONAL, default: TRUE
    optimizer text, -- OPTIONAL, default: 'fista'
    optimizer_params text, -- OPTIONAL, defaut: NULL
    excluded text, -- OPTIONAL, default: NULL
    max_iter integer, -- OPTIONAL, default: 1000
    tolerance float8 -- OPTIONAL, default is 1e-6
returns text;
</pre></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tbl_source</td><td>The name of the table containing the training data. </td></tr>
    <tr><td class="paramname">tbl_result</td><td>Name of the generated table containing the output model. </td></tr>
    <tr><td class="paramname">col_dep_var</td><td>Name of label column in input table. </td></tr>
    <tr><td class="paramname">col_ind_var</td><td>Name of features column in input table. Use '*' to specify all columns of tbl_source except those listed in the excluded string. </td></tr>
    <tr><td class="paramname">regress_family</td><td>The regression type, either 'gaussian' ('linear') or 'binomial' ('logistic'). </td></tr>
    <tr><td class="paramname">alphas</td><td>List of elastic net control parameters, values in [0, 1], 1 for L-1 regularization, 0 for L-2. </td></tr>
    <tr><td class="paramname">lambdas</td><td>List of regularization parameter, positive values. </td></tr>
    <tr><td class="paramname">id_column</td><td>The name of id column in input table. </td></tr>
    <tr><td class="paramname">mdl_table</td><td>intermediate table to store elastic net models </td></tr>
    <tr><td class="paramname">k_folds</td><td>The number of folds for cross-validation. </td></tr>
    <tr><td class="paramname">standardize</td><td>(optional) Whether to normalize the data. Setting this to TRUE usually yields better results and faster convergence. Default: TRUE. </td></tr>
    <tr><td class="paramname">optimizer</td><td>(optional) The name of optimizer, either 'fista' or 'igd'. Default: 'fista'. </td></tr>
    <tr><td class="paramname">optimizer_params</td><td>(optional) Optimizer parameters, delimited with commas, defaut: NULL. </td></tr>
    <tr><td class="paramname">excluded</td><td>(optional) If the col_ind_var input is '*' then excluded can be provided as a comma-delimited list of column names that are to be excluded from the features. Default: NULL </td></tr>
    <tr><td class="paramname">max_iter</td><td>(optional) The maximum number of iterations that are allowed. Default: 1000. </td></tr>
    <tr><td class="paramname">tolerance</td><td>(optional) Criteria to end iterations. Default is 1e-6.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Name of table in which grid search results are saved.</dd></dl>
<p><a class="anchor" id="elasticnet_usage"></a></p><dl class="section user"><dt>Usage</dt><dd>Given an array of alphas and lambdas, the function runs MADlib's Elastic Net Regularization with k-fold cross-validation. The resulting table contains the AUC values for each model iteration. Refer to <a href="https://madlib.incubator.apache.org/docs/latest/group__grp__elasticnet.html">MADlib Elastic Net Regression</a> for more information.</dd></dl>
<p><a class="anchor" id="elasticnet_example"></a></p><dl class="section user"><dt>Examples</dt><dd>Create sample data. <pre class="fragment">DROP TABLE IF EXISTS houses_sample;
CREATE TABLE houses_sample ( id INT,
                      tax INT,
                      bedroom INT,
                      bath FLOAT,
                      price INT,
                      size INT,
                      lot INT
                    );
COPY houses_sample FROM STDIN WITH DELIMITER '|';
  1 |  590 |       2 |    1 |  50000 |  770 | 22100
  2 | 1050 |       3 |    2 |  85000 | 1410 | 12000
  3 |   20 |       3 |    1 |  22500 | 1060 |  3500
  4 |  870 |       2 |    2 |  90000 | 1300 | 17500
  5 | 1320 |       3 |    2 | 133000 | 1500 | 30000
  6 | 1350 |       2 |    1 |  90500 |  820 | 25700
  7 | 2790 |       3 |  2.5 | 260000 | 2130 | 25000
  8 |  680 |       2 |    1 | 142500 | 1170 | 22000
  9 | 1840 |       3 |    2 | 160000 | 1500 | 19000
 10 | 3680 |       4 |    2 | 240000 | 2790 | 20000
 11 | 1660 |       3 |    1 |  87000 | 1030 | 17500
 12 | 1620 |       3 |    2 | 118600 | 1250 | 20000
 13 | 3100 |       3 |    2 | 140000 | 1760 | 38000
 14 | 2070 |       2 |    3 | 148000 | 1550 | 14000
 15 |  650 |       3 |  1.5 |  65000 | 1450 | 12000
\.
</pre></dd></dl>
<p>Run elastic net with some different alphas and lambdas. </p><pre class="fragment">select gs_elasticnet_cv(
    'houses',
    'houses_en',
    'price',
    'array[tax, bath, size]',
    'gaussian',
    ARRAY[0.05, 0.20], -- alphas
    ARRAY[0.05, 0.20], -- lambdas
    'id',
    'elastic_net_mdls',
    2,
    TRUE,
    'fista',
    NULL,
    NULL,
    10000,
    1e-6
);
             gs_elasticnet_cv             
------------------------------------------
 Grid search results written to houses_en
(1 row)
</pre><p>View results. </p><pre class="fragment">select * from houses_en;
 alpha | lamda | fold | auc 
-------+-------+------+-----
  0.05 |   0.2 |    0 | 0.5
  0.05 |   0.2 |    1 | 0.5
  0.05 |  0.05 |    0 | 0.5
  0.05 |  0.05 |    1 | 0.5
   0.2 |  0.05 |    0 | 0.5
   0.2 |  0.05 |    1 | 0.5
   0.2 |   0.2 |    0 | 0.5
   0.2 |   0.2 |    1 | 0.5
(8 rows)
</pre> </div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.nl/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.7
</small></address>
</body>
</html>
