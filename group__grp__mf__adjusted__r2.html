<!-- HTML header for doxygen 1.8.7-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="pdltools_extra.css" rel="stylesheet" type="text/css"/>
<!-- Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-47128600-1', 'auto');
    ga('send', 'pageview');
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="pdl.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">PDL Tools
   &#160;<span id="projectnumber">1.5</span>
   </div>
   <div id="projectbrief">User Documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="gettingstarted.html"><span>Getting&#160;Started</span></a></li>
      <li><a href="installpage.html"><span>Installation</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="changelog.html"><span>Change&#160;Log</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Groups</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">mf_adjusted_r2<div class="ingroups"><a class="el" href="group__grp__prediction__metrics.html">Prediction Metrics</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><b>Contents</b> </p><ul>
<li class="level1">
<a href="#mf_adjusted_r2_syntax">Syntax</a> </li>
<li class="level1">
<a href="#mf_adjusted_r2_linkage_usage">Usage</a> </li>
<li class="level1">
<a href="#mf_adjusted_r2_example">Example</a> </li>
</ul>
</div><dl class="section user"><dt>About</dt><dd>An aggregate calculating the adjusted R-squared prediction accuracy metric.</dd></dl>
<p><a class="anchor" id="mf_adjusted_r2_syntax"></a></p><dl class="section user"><dt>Syntax</dt><dd><pre class="syntax">
AGGREGATE mf_adjusted_r2(prediction FLOAT8, observed FLOAT8,
                         num_predictors INTEGER, training_size INTEGER)
RETURNS FLOAT8
</pre></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">prediction</td><td>The column of predicted values. </td></tr>
    <tr><td class="paramname">observed</td><td>The column of observed values. </td></tr>
    <tr><td class="paramname">num_predictors</td><td>The number of parameters in the predicting model, not counting the constant term. Should be an integer constant. </td></tr>
    <tr><td class="paramname">training_size</td><td>The number of rows used for training, excluding any NULL rows. Should be an integer constant.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The adjusted R2 value.</dd></dl>
<p><a class="anchor" id="mf_adjusted_r2_usage"></a></p><dl class="section user"><dt>Usage</dt><dd>An aggregate taking two columns, a "prediction" column and an "observed" column, as well as two integers describing the degrees of freedom of the model and the size of the training set over which it was developed, and returning the adjusted R-squared prediction accuracy metric.</dd></dl>
<p>Rows containing NULLs are ignored.</p>
<p><a class="anchor" id="mf_adjusted_r2_example"></a></p><dl class="section user"><dt>Examples</dt><dd></dd></dl>
<p>Assume we have trained a model and used it to reach predictions on certain values of the independent parameters. (In the example, these values are taken to be from a "test_set", implying that they are distinct from those values on which the model was trained. However, in real usage the function may be used also on the training set, although the interpretation of the results will be different.) In parallel, for each set of values of the independent parameters we also have the ground truth, e.g. an observed value.</p>
<p>We place the predicted and observed values into the "pred" and "obs" columns of the "test_set" table, respectively.</p>
<p>For the example, we create the table manually.</p>
<div class="fragment"><div class="line">user=# CREATE TABLE test_set(</div>
<div class="line">user(#                       pred FLOAT8,</div>
<div class="line">user(#                       obs FLOAT8</div>
<div class="line">user(#                      ) DISTRIBUTED RANDOMLY;</div>
<div class="line">CREATE TABLE</div>
<div class="line">user=# INSERT INTO test_set VALUES</div>
<div class="line">user-#   (37.5,53.1),(12.3,34.2), (74.2,65.4), (91.1,82.1);</div>
<div class="line">INSERT 0 4</div>
</div><!-- fragment --><p> <br />
Now, we use the aggregate to calculate the metric. The parameter '3' indicates that other than the constant term, the model has three parameters (e.g., it may take the form 7+5x+39y+0.91z). The parameter '100' indicates that the model was trained on a traininst set with 100 rows (excluding any NULL rows). Neither of these parameters can be deduced from the predicted values and the test set data alone. </p><div class="fragment"><div class="line">user=# SELECT <a class="code" href="prediction__metrics_8sql__in.html#a2bd145601b32afff5946240741a8bcae">mf_adjusted_r2</a>(pred,obs,3,100) FROM test_set;</div>
<div class="line">  <a class="code" href="prediction__metrics_8sql__in.html#a2bd145601b32afff5946240741a8bcae">mf_adjusted_r2</a>   </div>
<div class="line">-------------------</div>
<div class="line"> 0.257426872457228</div>
<div class="line">(1 row)</div>
</div><!-- fragment --> </div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.7
</small></address>
</body>
</html>
