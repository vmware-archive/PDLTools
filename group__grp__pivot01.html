<!-- HTML header for doxygen 1.8.7-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="pdltools_extra.css" rel="stylesheet" type="text/css"/>
<!-- Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-47128600-1', 'auto');
    ga('send', 'pageview');
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="pdl.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">PDL Tools
   &#160;<span id="projectnumber">1.8</span>
   </div>
   <div id="projectbrief">User Documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="gettingstarted.html"><span>Getting&#160;Started</span></a></li>
      <li><a href="installpage.html"><span>Installation</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="changelog.html"><span>Change&#160;Log</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Groups</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">pivot01 (Pseudofunction)<div class="ingroups"><a class="el" href="group__grp__sugar__funcs.html">SUgAR Pseudofunctions</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><b>Contents</b> </p><ul>
<li class="level1">
<a href="#pivot01_syntax">Syntax</a> </li>
<li class="level1">
<a href="#pivot01_usage">Usage</a> </li>
<li class="level1">
<a href="#pivot01_example">Example</a> </li>
</ul>
</div><dl class="section user"><dt>About</dt><dd>A SUgAR pseudo-row-function, splitting a categorical column into multiple 0/1 columns.</dd></dl>
<p><a class="anchor" id="pivot01_syntax"></a></p><dl class="section user"><dt>Syntax</dt><dd><pre class="syntax">
pivot01(x,t)
</pre> Expand <em>x</em> into 0-1 columns based on its values in table <em>t</em> (typically, the present table).</dd></dl>
<pre class="syntax">
pivot01(x,t,c)
</pre><p> Same as <code>pivot01(<em>x</em>,<em>t</em>)</code>, but take values from column <em>t.c</em>, rather than <em>t.x</em>.</p>
<pre class="syntax">
pivot01(x,t,c,formatspec)
</pre><p> Same as <code>pivot01(<em>x</em>,<em>t</em>,<em>c</em>)</code>, but use a user-defined naming-convention for the generated columns.</p>
<pre class="syntax">
pivot01(x,t,c,formatspec,colchoice)
</pre><p> Same as <code>pivot01(<em>x</em>,<em>t</em>,<em>c</em>,<em>formatspec</em>)</code>, but specify which columns to create.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">x</td><td>The categorical column to be expanded into 0-1 columns. </td></tr>
    <tr><td class="paramname">t</td><td>A table. The columns to be generated correspond to the values of column <em>t.x</em>. </td></tr>
    <tr><td class="paramname">c</td><td>When used, columns are generated based on <em>t.c</em> rather than <em>t.x</em>. To revert to <em>t.x</em>, use the value <code>'NULL'</code> for <em>c</em>. </td></tr>
    <tr><td class="paramname">formatspec</td><td>Specification of the method by which to generate names for the 0/1 column. By default, or if given a <code>NULL</code>, the value of <em>formatspec</em> is taken to be the string <code>'{c}_{v}'</code>. This specifies that the names of columns generated is the lowercase original column name followed by an underscore, followed by the lowercase value associated with the column. Any string can be used instead of formatspec (however, the string must be properly string-quoted). The string is taken literally, except for the fact that appearances of <code>'{c}'</code>, <code>'{v}'</code>, <code>'{C}'</code> and <code>'{V}'</code> in the original string are replaced by the lower-cased column name, the lower-cased column value, the original-case column name and the original-case column value, respectively. Alternatively, one can supply the name of a function instead of a string. This would cause this function to be called with two parameters (the column name and the column value). The function should return a text string, and that string will be used as the name of the generated column. </td></tr>
    <tr><td class="paramname">colchoice</td><td>A text parameter, allowing the caller explicit control over which columns are created in pivoting. The parameter's value is interpretted as string containing an (immutable) query that returns a table with a column called <code>"col_name"</code>. The values in this column will be the columns created. Prior to evaluating the string as a query, instances of <code>'{col}'</code> in it are replaced by the name of the column from which values are to be generated (<em>'t.c'</em> if parameter <em>'c'</em> is specified and non-NULL, <em>'t.x'</em>, otherwise), and, similarly, instances of <code>'{tabl}</code>' are replaced by the value in parameter <em>'t'</em>. The default value for this parameter is <code>"SELECT DISTINCT {col} AS col_name FROM {tabl};"</code>. SUgAR provides several convenience functions (<code>"ALL_VALS"</code>, <code>"FREQ_VALS"</code> and <code>"ALL_BUT_ONE"</code>) which can be used to as the <em>'colchoice'</em> parameter: use <code>'all_vals()'</code> to create all columns, as is the default behavior; use <code>'freq_vals(<em>n</em>)'</code>, for any <em>n</em> value, to create columns only for the top <em>n</em> most frequent values. Use <code>'all_but_one()'</code> to create all columns except for an arbitrarily chosen one. (This last option is useful for avoiding colinearity in the output.)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>This pseudofunction returns multiple <code>integer</code> columns (which is not a return type available for a row function in standard SQL).</dd></dl>
<p><a class="anchor" id="pivot01_usage"></a></p><dl class="section user"><dt>Usage</dt><dd>This SUgAR pseudofunction acts as a list of row functions, creating multiple columns. Each column generated represents a possible value of the original categorical column (<em>'x'</em>). In a row where this possible value matches the original categorical column's actual value, the generated column's value is '1'. Otherwise, it is '0'.</dd></dl>
<dl class="section note"><dt>Note</dt><dd><code>'pivot01'</code> is a pseudofunction, not a pseudo-aggregate. If you want to use pivoting in conjunction with grouping, see <a class="el" href="group__grp__pivot.html">pivot (Pseudo-aggregate)</a>.</dd></dl>
<p><a class="anchor" id="pivot01_example"></a></p><dl class="section user"><dt>Examples</dt><dd><pre class="fragment">user=# CREATE TABLE wiki_table (region text, gender text, style text,
user(#                          ship_date date, units integer,
user(#                          price float8, cost float8, row_num integer)
user-# DISTRIBUTED BY (row_num);
CREATE TABLE
user=#
user=# INSERT INTO wiki_table VALUES
user-# ('East', 'Girl', 'Tee', '1/31/05', 12, 11.04, 10.42, 1),
user-# ('East', 'Boy', 'Golf', '4/30/05', 12, 13, 12.6, 2),
user-# (NULL , 'Boy', 'Tee', '3/31/05', 10, 11.96, 11.74, 3),
user-# ('West', 'Girl', 'Tee', '4/30/05', 12, 11.27, 10.56, 4),
user-# ('West', 'Girl', 'Fancy', '6/30/05', 11, 12.12, 11.95, 5),
user-# ('South', 'Boy', 'Fancy', '5/31/05', 15, 13.47, 13.33, 6),
user-# ('South', 'Girl', 'Golf', '1/31/05', 15, 11.44, 10.94, 7),
user-# ('North', 'Girl', 'Golf', '2/28/05', 12, 12.63, 11.73, 8),
user-# ('South', 'Girl', 'Fancy', '6/30/05', 10, 12.06, 11.51, 9),
user-# ('West', 'Boy', 'Tee', '2/28/05', 12, 13.42, 13.29, 10),
user-# ('East', 'Boy', 'Tee', '1/31/05', 11, 11.48, 10.67, 11)
user-# ;
INSERT 0 11
user=# -- Table data from Wikipedia 'pivoting' entry.
user=#
user=# SELECT sugar($$
user$#   CREATE TABLE outtable AS SELECT price,units,cost,row_num,
user$#     pivot01(region,wiki_table,null,'{v}', freq_vals(3))
user$#   FROM wiki_table
user$#   DISTRIBUTED BY (row_num);
user$# $$);
 sugar 
-------
 
(1 row)

user=# SELECT * FROM outtable;
 price | units | cost  | row_num | west | east | south 
-------+-------+-------+---------+------+------+-------
 11.04 |    12 | 10.42 |       1 |    0 |    1 |     0
 11.96 |    10 | 11.74 |       3 |    0 |    0 |     0
 12.12 |    11 | 11.95 |       5 |    1 |    0 |     0
 11.44 |    15 | 10.94 |       7 |    0 |    0 |     1
 12.06 |    10 | 11.51 |       9 |    0 |    0 |     1
 11.48 |    11 | 10.67 |      11 |    0 |    1 |     0
    13 |    12 |  12.6 |       2 |    0 |    1 |     0
 11.27 |    12 | 10.56 |       4 |    1 |    0 |     0
 13.47 |    15 | 13.33 |       6 |    0 |    0 |     1
 12.63 |    12 | 11.73 |       8 |    0 |    0 |     0
 13.42 |    12 | 13.29 |      10 |    1 |    0 |     0
(11 rows)
</pre></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__grp__pivot.html" title="Cross-tabulate one column according to another. ">pivot (Pseudo-aggregate)</a>, <a class="el" href="group__grp__all__vals.html">all_vals</a>, <a class="el" href="group__grp__freq__vals.html">freq_vals</a>, <a class="el" href="group__grp__all__but__one.html">all_but_one</a>, <a class="el" href="group__grp__choose__any.html">choose_any (Aggregate)</a>, <a class="el" href="group__grp__unique__element.html">unique_element (Aggregate)</a></dd></dl>
<p>(Written by <a href="#" onclick="location.href='mai'+'lto:'+'mbr'+'an'+'d@p'+'iv'+'ota'+'l.'+'io'; return false;">Michael Brand</a>, 3 Mar 2013.) </p>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.nl/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.7
</small></address>
</body>
</html>
